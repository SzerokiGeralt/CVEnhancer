<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:CVEnhancer.ViewModels"
             xmlns:models="clr-namespace:CVEnhancer.Models"
             x:Class="CVEnhancer.DataPage"
             x:DataType="vm:DataPageViewModel"
             Title="Moje Dane">

    <Grid RowDefinitions="Auto,*">
        <!-- Zakładki -->
        <HorizontalStackLayout Grid.Row="0" Spacing="10" Padding="10">
            <Button Text="Dane Osobowe" Clicked="OnPersonalDataClicked" x:Name="PersonalDataTab" />
            <Button Text="Praca" Clicked="OnWorkClicked" x:Name="WorkTab" />
            <Button Text="Edukacja" Clicked="OnEducationClicked" x:Name="EducationTab" />
            <Button Text="Projekty" Clicked="OnProjectsClicked" x:Name="ProjectsTab" />
            <Button Text="Certyfikaty" Clicked="OnCertificatesClicked" x:Name="CertificatesTab" />
        </HorizontalStackLayout>

        <!-- Zawartość zakładek -->
        <ScrollView Grid.Row="1" Padding="20" VerticalScrollBarVisibility="Always">
            <VerticalStackLayout Spacing="15" x:Name="ContentArea">
                
                <!-- Dane Osobowe -->
                <VerticalStackLayout x:Name="PersonalDataContent" Spacing="10">
                    <Label Text="Dane Osobowe" FontSize="24" />
                    <Border WidthRequest="160"
                            HeightRequest="160"
                            StrokeThickness="0"
                            HorizontalOptions="Center">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="160"/>
                        </Border.StrokeShape>
                        <Image Source="{Binding ProfileImageSource}"
                               Aspect="AspectFill"
                               WidthRequest="160"
                               HeightRequest="160"/>
                    </Border>
                    <Button Text="Wybierz nowe zdjęcie" Clicked="ChangeProfilePictureClicked" />
                    <Entry Placeholder="Imię" Text="{Binding CurrentUser.FirstName}" />
                    <Entry Placeholder="Nazwisko" Text="{Binding CurrentUser.LastName}" />
                    <Entry Placeholder="Email" Text="{Binding CurrentUser.Email}" Keyboard="Email" />
                    <Entry Placeholder="Telefon" Text="{Binding CurrentUser.PhoneNumber}" Keyboard="Telephone" />
                    <Entry Placeholder="LinkedIn URL" Text="{Binding CurrentUser.LinkedInUrl}" />
                    <Entry Placeholder="GitHub URL" Text="{Binding CurrentUser.GitHubUrl}" />
                    <Entry Placeholder="Portfolio URL" Text="{Binding CurrentUser.PortfolioUrl}" />
                    <Entry Placeholder="Stanowisko" Text="{Binding CurrentUser.JobTitle}" />
                    <Editor Placeholder="Podsumowanie profesjonalne" Text="{Binding CurrentUser.ProfessionalSummary}" HeightRequest="100" />
                    <Button Text="Zapisz zmiany" Clicked="SaveClicked" />
                    <Button Text="Usuń Profil" Clicked="DeleteProfileClicked" BackgroundColor="Red" TextColor="White"/>
                </VerticalStackLayout>

                <!-- Praca -->
                <VerticalStackLayout x:Name="WorkContent" Spacing="10" IsVisible="False">
                    <Label Text="Doświadczenie Zawodowe" FontSize="24" />
                    <Entry Placeholder="Nazwa firmy" Text="{Binding CurrentWork.CompanyName}" />
                    <Entry Placeholder="Stanowisko" Text="{Binding CurrentWork.JobTitle}" />
                    <!-- TODO: BINDOWANIE -->
                    <Editor Placeholder="Tagi technologii i umiejętności" Text="" HeightRequest="100" />
                    <Label Text="Data rozpoczęcia" />
                    <DatePicker Date="{Binding CurrentWork.StartDate}" />
                    <Label Text="Data zakończenia (opcjonalnie)" />
                    <DatePicker Date="{Binding WorkEndDate}" />
                    <Editor Placeholder="Opis obowiązków" Text="{Binding CurrentWork.Description}" HeightRequest="100" />
                    <Button Text="Dodaj wpis" Command="{Binding AddWorkCommand}" />
                    
                    <Label Text="Lista doświadczeń:" FontSize="18" Margin="0,20,0,10" />
                    <CollectionView ItemsSource="{Binding WorkExperiences}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:WorkExperience">
                                <Border Padding="10" Margin="0,5">
                                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="*,*">
                                        <Label Grid.Column="0" Grid.Row="0" Text="{Binding JobTitle}" VerticalOptions="Center" />
                                        <Label Grid.Column="0" Grid.Row="1" Text="{Binding Description}" VerticalOptions="Center" />
                                        <Button Grid.Column="1" Grid.RowSpan="1" Text="Usuń" 
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.DeleteWorkCommand}"
                                                CommandParameter="{Binding .}" />
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>

                <!-- Edukacja -->
                <VerticalStackLayout x:Name="EducationContent" Spacing="10" IsVisible="False">
                    <Label Text="Edukacja" FontSize="24" />
                    <Entry Placeholder="Nazwa uczelni" Text="{Binding CurrentEducation.InstitutionName}" />
                    <Entry Placeholder="Kierunek studiów" Text="{Binding CurrentEducation.FieldOfStudy}" />
                    <Entry Placeholder="Stopień" Text="{Binding CurrentEducation.Degree}" />
                    <!-- TODO: BINDOWANIE -->
                    <Editor Placeholder="Tagi technologii i umiejętności" Text="" HeightRequest="100" />
                    <Label Text="Data rozpoczęcia" />
                    <DatePicker Date="{Binding CurrentEducation.StartDate}" />
                    <Label Text="Data zakończenia (opcjonalnie)" />
                    <DatePicker Date="{Binding EducationEndDate}" />
                    <Button Text="Dodaj wpis" Command="{Binding AddEducationCommand}" />
                    
                    <Label Text="Lista edukacji:" FontSize="18" Margin="0,20,0,10" />
                    <CollectionView ItemsSource="{Binding Educations}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:Education">
                                <Border Padding="10" Margin="0,5">
                                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="*,*">
                                        <Label Grid.Column="0" Grid.Row="0" Text="{Binding InstitutionName}" VerticalOptions="Center" />
                                        <Label Grid.Column="0" Grid.Row="1" Text="{Binding FieldOfStudy}" VerticalOptions="Center" />
                                        <Button Grid.Column="1" Grid.RowSpan="1" Text="Usuń" 
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.DeleteEducationCommand}"
                                                CommandParameter="{Binding .}" />
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>

                <!-- Projekty -->
                <VerticalStackLayout x:Name="ProjectsContent" Spacing="10" IsVisible="False">
                    <Label Text="Projekty" FontSize="24" />
                    <Entry Placeholder="Nazwa projektu" Text="{Binding CurrentProject.Name}" />
                    <Editor Placeholder="Opis projektu" Text="{Binding CurrentProject.Description}" HeightRequest="100" />
                    <!-- TODO: BINDOWANIE -->
                    <Editor Placeholder="Tagi technologii i umiejętności" Text="" HeightRequest="100" />
                    <Entry Placeholder="URL projektu (opcjonalnie)" Text="{Binding CurrentProject.ProjectUrl}" />
                    <Button Text="Dodaj projekt" Command="{Binding AddProjectCommand}" />
                    
                    <Label Text="Lista projektów:" FontSize="18" Margin="0,20,0,10" />
                    <CollectionView ItemsSource="{Binding Projects}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:Project">
                                <Border Padding="10" Margin="0,5">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Label Text="{Binding Name}" VerticalOptions="Center" />
                                        <Button Grid.Column="1" Text="Usuń" 
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.DeleteProjectCommand}"
                                                CommandParameter="{Binding .}" />
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>

                <!-- Certyfikaty -->
                <VerticalStackLayout x:Name="CertificatesContent" Spacing="10" IsVisible="False">
                    <Label Text="Certyfikaty" FontSize="24" />
                    <Entry Placeholder="Nazwa certyfikatu" Text="{Binding CurrentCertificate.Name}" />
                    <Entry Placeholder="Organizacja wydająca" Text="{Binding CurrentCertificate.IssuingOrganization}" />
                    <!-- TODO: BINDOWANIE -->
                    <Editor Placeholder="Tagi technologii i umiejętności" Text="" HeightRequest="100" />
                    <Label Text="Data wydania" />
                    <DatePicker Date="{Binding CurrentCertificate.IssueDate}" />
                    <Label Text="Data wygaśnięcia (opcjonalnie)" />
                    <DatePicker Date="{Binding CertificateExpirationDate}" />
                    <Entry Placeholder="ID poświadczenia" Text="{Binding CurrentCertificate.CredentialId}" />
                    <Entry Placeholder="URL poświadczenia" Text="{Binding CurrentCertificate.CredentialUrl}" />
                    <Button Text="Dodaj certyfikat" Command="{Binding AddCertificateCommand}" />
                    
                    <Label Text="Lista certyfikatów:" FontSize="18" Margin="0,20,0,10" />
                    <CollectionView ItemsSource="{Binding Certificates}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="models:Certificate">
                                <Border Padding="10" Margin="0,5">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <Label Text="{Binding Name}" VerticalOptions="Center" />
                                        <Button Grid.Column="1" Text="Usuń" 
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.DeleteCertificateCommand}"
                                                CommandParameter="{Binding .}" />
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>

</ContentPage>